close all
clear all
clc

deltaT = 1/50
Rminus = [1 0 0;0 1 0;0 0 1];
Bminus = [1;2;3];

magIner = [22.770;5.329;41.5102];
AccIner = [0;0;1];

tendata = [-0.0410 -0.0873 -0.0025;
           -0.0426 -0.0840 -0.0022;
           -0.0416 -0.0843 0.0025;
           -0.0416 -0.0862, 0.0132;
           -0.0454 -0.0869, 0.0350;
           -0.0432 -0.0872, 0.0556;
           -0.0413 -0.0854, 0.0911;
           -0.0377 -0.0842, 0.1268;
           -0.0424 -0.0843, 0.1689;
           -0.0428 -0.0852, 0.2178];

tenacc = [0.9266 0.0493 -0.3354;
           0.9258 0.0487 -0.3571;
           0.9396 0.0274 -0.3546;
           0.9225 0.0264 -0.3550;
           0.9326 0.0397 -0.3414;
           0.9302 0.0327 -0.3533;
           0.9234 0.0447 -0.3523;
           0.9307 0.0326 -0.3442;
           0.9409 0.0189 -0.3569;
           0.9362 0.0187 -0.3692];
       
tenmag = [0.9134 0.4060 -0.0014;
           0.9108 0.3972 -0.0028;
           0.9206 0.4021 0.01057;
           0.9227 0.3983 0.01604;
           0.9088 0.3959 -0.0137;
           0.9257 0.3991 0.01032;
           0.9196 0.4054 0.01763;
           0.9114 0.3998 -0.0086;
           0.9167 0.3887 0.01254;
           0.9402 0.3887 -0.0109];
       
 
for i = 1 : 10
    gyro = [tendata(i,1);tendata(i,2);tendata(i,3)];
    mag = [tenmag(i,1);tenmag(i,2);tenmag(i,3)];
    acc = [tenacc(i,1);tenacc(i,2);tenacc(i,3)];
    
    [Rplus, Bplus] = IntegrateClosedLoop(Rminus, Bminus, gyro, mag, acc, magIner, AccIner, deltaT)
    Rminus = Rplus;
    Bminus = Bplus;
end



       
